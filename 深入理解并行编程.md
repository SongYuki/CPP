# 深入理解并行编程

标签： multiple_programming

---

目的：编写基于共享内存的并行程序

展示工程项目，避免新一代并行编程黑客重复发明一些旧轮子，从而集中精力和创造力到新的领域。

**并行编程是一个黑客可以参与解决问题的最困难领域之一**

论文和教科书已经警告过我们关于死锁，活锁，竞争条件，不确定性，扩展性限制，实时延迟等等方面的危险。

<h3>并行编程曾经的困难</h3>

 1. 并行系统曾经的高价格以及它相对罕见
 2. 研究人员以及从业人员缺乏并行系统的经验
 3. 很少有公开可访问的并行代码
 4. 缺少并行编程的工程经验
 5. 处理器间通信代价高昂，即使是紧耦合的共享内存计算机系统也是如此。

实际上，在2008年的时候，再找一个单核cpu桌面系统已经是一件困难的事情了。单核cpu仅仅与上网本及嵌入式设备相关。甚至在2012年的时候，智能手机也开始使用多cpu了。

在21世纪，已经有大量开源的并行软件项目出现。这其中包含linux内核，数据库系统，消息传递系统。

不过，即使并行编程不像通常宣传的那么困难，它也比串行编程有更多得到工作需要做。

大多数并行编程所要达到的目标，主要是性能

编写单线程代码并简单的等待cpu一两年时间，这不再是一个可行的方法。所有主流厂商最近的趋势是朝多核/多线程系统发展，并行化是充分利用这些系统性能的好办法。

如果你的串行程序需要优化为并行程序，你需要将并行算法与最优的串行算法进行比较。

不幸的是，通用性会带来更大的性能损失或者生产率损失，或者兼而有之。要明白这点，考虑下面这些流行的并行编程环境：

 1. C/C++ “锁及线程”
 2. 自动进行垃圾收集，并且拥有大量的类型库。
 3. MPI：这个消息传递接口大量的向全球范围内的科学技术计算提供集群能力，它提供无与伦比的性能和可扩展性。理论上讲它实现了通用的目标，但是通常情况被用于科学计算
 4. OpenMP:这个编译指令集能被用于并行循环，因此被用于特定任务，这也限制了它的性能。但是，它比MPI和C/C++更简单
 5. SQL：仅仅运用于关系数据库查询
 

<h4>使用现有的并行软件</h4>
这些并行软件包括关系数据库，web服务器，以及mao-reduce环境。

<h4>对串行程序性能优化</h4>
来自并行计算的速度提升，与cpu个数大约成正比，而对软件进行优化，带来的性能提升是指数级的。
不同的程序会有不同的性能瓶颈，并行计算只能对某些瓶颈有所帮助

**工作分割**
大量的线程可能会带来大量计算和I/O操作，以及通信所产生的开销。
好的并行设计可能拥有巨大的状态空间，不过却由于他们采用了通用的结构，以便于理解。

在许多消息传递环境中，对本地变量的访问时通过表达式和赋值，但是远程变量访问是通过一套完全不同的语法，通常是引入消息传递机制。

**线程如何协调访问资源**
由集中并行语言和环境提供的多种同步机制来处理，这些机制包括消息传递，加锁，事务，引用计数，显式计时，共享原子变量，以及数据所有权。
需要传统的并行编程关注由此引出的死锁，活锁，和事务回滚。
如果要详细讨论这些机制，需要涉及到同步机制的比较，比如对加锁和事务内存进行比较。